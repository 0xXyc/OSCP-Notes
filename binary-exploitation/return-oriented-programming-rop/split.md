---
description: 09/23/2023
---

# ðŸ’” split

## Introduction

We can still use a similar methodology to complete this challenge and this is still a _**ret2win**_, but with a bit of a twist.

## Challenge

{% embed url="https://ropemporium.com/challenge/split.html" %}

### Hint

The challenge author told us that the string <mark style="color:yellow;">`"/bin/cat flag.txt"`</mark> is still present in the binary.

Also, a call to <mark style="color:yellow;">`system()`</mark> is present as well.

<mark style="color:yellow;">We simply need to chain them together to exploit our binary</mark>.

## References

{% embed url="https://github.com/radareorg/radare2/blob/master/doc/intro.md" %}

## x86 Exploitation

### Enumeration

`file`:

{% code overflow="wrap" %}
```
split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped
```
{% endcode %}

* 32-bit
* dynamically linked
* not stripped

`checksec`:

```
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
```

* NX enabled, making ROP a great technique

`rabin2`:

```
rabin2 -I split

arch     x86
baddr    0x8048000
binsz    6256
bintype  elf
bits     32
canary   false
injprot  false
class    ELF32
compiler GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  Intel 80386
nx       true
os       linux
pic      false
relocs   true
relro    partial
rpath    NONE
sanitize false
static   false
stripped false
subsys   linux
va       true
```

{% code overflow="wrap" %}
```
rabin2 -iz split32  
                                                                                                                        [Imports]                                                                                                                                                            nth vaddr      bind   type   lib name                                                                                                                                â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•                                                                                                                                1   0x080483b0 GLOBAL FUNC       read                                                                                                                                2   0x080483c0 GLOBAL FUNC       printf                                                                                                                              3   0x080483d0 GLOBAL FUNC       puts                                                                                                                                4   0x080483e0 GLOBAL FUNC       system                                                                                                                              5   0x00000420 WEAK   NOTYPE     __gmon_start__                                                                                                                      6   0x080483f0 GLOBAL FUNC       __libc_start_main                                                                                                                   7   0x08048400 GLOBAL FUNC       setvbuf                                                                                                                             8   0x08048410 GLOBAL FUNC       memset                                                                                                                                                                                                                                                                                                   [Strings]                                                                                                                                                            nth paddr      vaddr      len size section type  string                                                                                                              â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•                                                                                                              0   0x000006b0 0x080486b0 21  22   .rodata ascii split by ROP Emporium                                                                                               1   0x000006c6 0x080486c6 4   5    .rodata ascii x86\n                                                                                                               2   0x000006cb 0x080486cb 8   9    .rodata ascii \nExiting                                                                                                           3   0x000006d4 0x080486d4 43  44   .rodata ascii Contriving a reason to ask user for data...                                                                         4   0x00000703 0x08048703 10  11   .rodata ascii Thank you!                                                                                                          5   0x0000070e 0x0804870e 7   8    .rodata ascii /bin/ls                                                                                                             0   0x00001030 0x0804a030 17  18   .data   ascii /bin/cat flag.txt
```
{% endcode %}

* We can see a <mark style="color:yellow;">function call to</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">`system()`</mark>
* Inside of the <mark style="color:yellow;">data section of the ELF, we can see the string</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">`"/bin/cat flag.txt"`</mark>

**NOTE**: These are the two pieces of the puzzle that we need to "chain" together to _**ret2win**_.

### Reversing

