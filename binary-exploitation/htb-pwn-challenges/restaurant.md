---
description: 08/25/2023
---

# 🍽 Restaurant

## Challenge

{% embed url="https://app.hackthebox.com/challenges/restaurant" %}

## Description

> Welcome to our Restaurant. Here, you can eat and drink as much as you want! Just don't overdo it..

## Enumeration

`file`:

{% code overflow="wrap" %}
```
restaurant: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=34d48877c9e228a7bc7b66b34f0d4fa6353d20b4, not stripped
```
{% endcode %}

* <mark style="color:yellow;">64-bit</mark>
* <mark style="color:yellow;">Dynamically linked to the</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">`libc`</mark> <mark style="color:yellow;"></mark><mark style="color:yellow;">library</mark>
* <mark style="color:yellow;">Non-stripped binary</mark> (makes our life easier to reverse)

`checksec`:

```
[*] '/home/xyco/Projects/HTB/Restaurant/pwn_restaurant/restaurant'
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
```

The only <mark style="color:yellow;">memory protection</mark> put in place is the <mark style="color:yellow;">No Execute</mark> (NX) bit. This means that <mark style="color:yellow;">we do NOT have an executable stack</mark> and <mark style="color:yellow;">therefore cannot execute custom shellcode</mark> on the stack.&#x20;

This sounds more than likely to be a possible <mark style="color:yellow;">**ret2libc**</mark> challenge. Let's dig in some more.

**Why do I think this challenge is a ret2libc one?**

The reason I say **ret2libc** is because a <mark style="color:yellow;">common bypass for the NX bit</mark> set on a binary is to divert execution into the `libc` library as long as the file is <mark style="color:yellow;">dynamically linked</mark>, which it is!

## Reversing

