---
description: 07/17/23
---

# 1âƒ£ StackOne

> This level looks at the <mark style="color:yellow;">concept of modifying variables to specific values in the program</mark>, and <mark style="color:yellow;">how the variables are laid out in memory</mark>.

#### Hints

* `man ascii` can tell you what the hexadecimal characters are.
* Having troubles? How does the [endianness](https://en.wikipedia.org/wiki/Endianness) of the architecture affect the layout of how variables are laid out?

## Source Code

```c
/*
 * phoenix/stack-one, by https://exploit.education
 *
 * The aim is to change the contents of the changeme variable to 0x496c5962
 *
 * Did you hear about the kid napping at the local school?
 * It's okay, they woke up.
 *
 */

#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char buffer[64];
    volatile int changeme;
  } locals;

  printf("%s\n", BANNER);

  if (argc < 2) {
    errx(1, "specify an argument, to be copied into the \"buffer\"");
  }

  locals.changeme = 0;
  strcpy(locals.buffer, argv[1]);

  if (locals.changeme == 0x496c5962) {
    puts("Well done, you have successfully set changeme to the correct value");
  } else {
    printf("Getting closer! changeme is currently 0x%08x, we want 0x496c5962\n",
        locals.changeme);
  }

  exit(0);
}
```



## Exploitation

Let's simply execute the program and see what's going on to get a lay of the land:

<figure><img src="../../../.gitbook/assets/image (13) (8).png" alt=""><figcaption></figcaption></figure>

We can see from the output that we want the value `0x496c5962`.

We can also see from our source code:

```c
if (locals.changeme == 0x496c5962) 
{
    puts("Well done, you have successfully set changeme to the correct value");
} 
    
    else 
    {
    printf("Getting closer! changeme is currently 0x%08x, we want 0x496c5962\n",
        locals.changeme);
    }
```

In English, this means if our variable `locals.changeme` is equel to the hex value `0x496c5962`, then do the following.

With that said, we need to figure out the ascii value of our given hex value to complete the if statement's logic.

### Original Attempt

At first (if you were wondering where I ended up getting `IlYb` from), I thought I needed to just convert the hex to ascii and pass it the byte string, however this was not the case.

With one of our hints, we were reminded to be conscious of endianness (in this case we are on x64), so we are using little-endian to store data in memory. So we need to reverse `0x496c5962` to `\x62\x59\x6c\x49`.

<figure><img src="../../../.gitbook/assets/image (3) (6).png" alt=""><figcaption></figcaption></figure>

Okay we can see that since we are printing the hex value of our variable in the source code with `0x%08x`, we passed up value.

Keeping in mind that our struct in our source code created a 64-byte buffer via `[64]`, let's use this and see what happens.

<figure><img src="../../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>
