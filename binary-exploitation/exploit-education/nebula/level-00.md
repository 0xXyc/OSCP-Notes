# LEVEL 00

{% embed url="http://exploit.education/nebula/level-00/" %}

## Challenge

> This level requires you to _find_ a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.
>
> Alternatively, look at the find man page.
>
> To access this level, log in as level00 with the password of level00

This challenge was pretty easy to me due to my pentesting background and time spend on HTB.

Finding SUID's are relatively easy using the `find` command in addition to the GTFOBins resource.&#x20;

{% embed url="https://gtfobins.github.io/" %}

{% content-ref url="../../../privilege-escalation/linux/escalation-techniques.md" %}
[escalation-techniques.md](../../../privilege-escalation/linux/escalation-techniques.md)
{% endcontent-ref %}

{% embed url="https://www.tecmint.com/how-to-find-files-with-suid-and-sgid-permissions-in-linux/" %}

## Let's pwn

Let's see what `suid -l` gives us:

<figure><img src="../../../.gitbook/assets/image (12) (1).png" alt=""><figcaption></figcaption></figure>

There isn't anything of use from this. We can't run sudo on this host as the `level00` user.

Find SUID and SGID permissions on files from the root directory up:

```
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
```

However, if you just wanted to do SUID, which is what the challenge is asking for:

```
find . -perm /4000 
```

This command will print out any files that have the permissions of 4000 set.

Upon running this, I come across `/usr/bin/wall` which is listed in [GTFOBins](https://gtfobins.github.io/gtfobins/wall/).

However, this will not work because the user, `level00` is not in the sudoers file.

However, since we are looking for programs that can run as the level00 user, let's use the -user flag in find to specify which user we are targetting:

```
find / -user flag00 -perm -4000 2>/dev/null
```

<figure><img src="../../../.gitbook/assets/image (71).png" alt=""><figcaption></figcaption></figure>

Let's do some more enumeration.

We see an interesting binary `flag00`.

What permissions are set for this program?

We can find out with ls -la and be surprised to see that it's PWD is in red, meaning that our current user can execute this SUID-bit set program as our user and have it executed as another user.

<figure><img src="../../../.gitbook/assets/image (40).png" alt=""><figcaption></figcaption></figure>
